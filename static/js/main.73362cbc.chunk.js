(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,o){e.exports=o(22)},16:function(e,t,o){},18:function(e,t,o){},20:function(e,t,o){},22:function(e,t,o){"use strict";o.r(t);var a=o(0),i=o.n(a),n=o(9),r=o.n(n),l=(o(16),o(1)),s=o(2),c=o(4),u=o(3),h=o(5),d=o(7),f=o(10),p=(o(18),function(){function e(t,o){Object(l.a)(this,e),this.type=t,this.tile=e.tiles[t],this.color=e.colors[t],this.position=o||this.getInitialPosition(),this.rotation=0}return Object(s.a)(e,[{key:"clone",value:function(){var t=new e(this.type,this.position);return t.tile=this.tile,t.position=this.position.slice(),t.rotation=this.rotation,t}},{key:"getInitialPosition",value:function(){return[Math.floor((10-this.tile[0].length)/2),5===this.type?1:0]}},{key:"rotateClockwise",value:function(t){var o=this;this.rotation=(this.rotation+1)%4;var a,i=e.rotationClockwisePosition[this.type][this.rotation];return a=5===this.type?e.clockwiseWallKickI[this.rotation][t]:e.clockwiseWallKick[this.rotation][t],this.position[0]+=i[0]+a[0],this.position[1]+=i[1]+a[1],this.tile=this.tile[0].map(function(e,t){return o.tile.slice().reverse().map(function(e){return e[t]})}),this}},{key:"rotateAntiClockwise",value:function(t){var o=this;this.rotation=(this.rotation+3)%4;var a,i=e.rotationClockwisePosition[this.type][(this.rotation+1)%4];return a=5===this.type?e.antiClockwiseWallKickI[this.rotation][t]:e.antiClockwiseWallKick[this.rotation][t],this.position[0]-=i[0]-a[0],this.position[1]-=i[1]-a[1],this.tile=this.tile[0].map(function(e,t){return o.tile.map(function(e){return e[e.length-t-1]})}),this}}]),e}());p.tiles=[[[1,1,0],[0,1,1]],[[0,0,1],[1,1,1]],[[1,1],[1,1]],[[0,1,1],[1,1,0]],[[1,0,0],[1,1,1]],[[1,1,1,1]],[[0,1,0],[1,1,1]]],p.colors=["red","orange","yellow","green","blue","cyan","purple","grey"],p.rotationClockwisePosition=[[[0,0],[1,0],[-1,1],[0,-1]],[[0,0],[1,0],[-1,1],[0,-1]],[[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[-1,1],[0,-1]],[[0,0],[1,0],[-1,1],[0,-1]],[[-1,1],[2,-1],[-2,2],[1,-2]],[[0,0],[1,0],[-1,1],[0,-1]]],p.clockwiseWallKick=[[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]]],p.antiClockwiseWallKick=[[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]]],p.clockwiseWallKickI=[[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]]],p.antiClockwiseWallKickI=[[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]]];var w=p,k=function(e){function t(e){var o;Object(l.a)(this,t),(o=Object(c.a)(this,Object(u.a)(t).call(this,e))).initializeGame=function(){o.tile=null,o.shadow=null,o.keyPressing=o.keyPressing||new Set,o.canSpawn=!0,o.iteration=0,o.shouldFastForward=!1,o.shouldDown=!1,o.shouldLeft=!1,o.shouldRight=!1,o.shouldRotateClockwise=!1,o.shouldRotateAntiClockwise=!1,o.lastArrowKey="",o.resume()},o.pause=function(){o.shouldFastForward=!1,o.shouldDown=!1,o.shouldLeft=!1,o.shouldRight=!1,o.shouldRotateClockwise=!1,o.shouldRotateAntiClockwise=!1,o.setState({gameState:"pause"}),clearTimeout(o.updateTimer)},o.resume=function(){o.setState({gameState:"play"}),o.updateTimer=setTimeout(o.loop,o.updateInterval)},o.restart=function(){for(var e=o.props,t=e.map,a=e.height,i=e.width,n=new Array(a+1),r=0;r<n.length;r++)n[r]=new Array(i).fill(-1);for(var l=[],s=0;s<5;s++)l.push(Math.floor(7*Math.random()));o.setState({board:t||n,next:l}),o.initializeGame()},o.loop=function(){o.canSpawn?o.spawn():o.tile&&(o.shouldFastForward?(o.debug&&console.log("shouldFastForward"),o.fastForward()):(o.iteration===o.autoDownInterval&&(o.debug&&console.log("autoDown"),o.down(),o.iteration=0),o.shouldDown&&o.down(),o.shouldLeft||"ArrowLeft"===o.lastArrowKey?(o.left(),o.shouldLeft=!1):(o.shouldRight||"ArrowRight"===o.lastArrowKey)&&(o.right(),o.shouldRight=!1),o.shouldRotateClockwise&&(o.rotateClockwise(),o.shouldRotateClockwise=!1),o.shouldRotateAntiClockwise&&(o.rotateAntiClockwise(),o.shouldRotateAntiClockwise=!1),o.iteration+=1),o.shouldFastForward=!1),"play"===o.state.gameState&&(o.updateTimer=setTimeout(o.loop,o.updateInterval))},o.spawn=function(){o.debug&&console.log("spawn"),o.canSpawn=!1,o.lockTimer=null,o.tile=new w(o.getNextTileType());var e=o.state.board.map(function(e){return e.slice()});o.checkCanPlace(e,o.tile,!0)?o.placeTile(e,o.tile):o.setState({gameState:"gameover"})},o.handleKeyDown=function(e){"start"===o.state.gameState?o.initializeGame():"play"===o.state.gameState?o.keyPressing.has(e.key)||("Escape"===e.key?o.pause():" "===e.key?o.shouldFastForward=!0:"ArrowLeft"===e.key?(o.shouldLeft=!0,o.lastArrowKey="ArrowLeft"):"ArrowRight"===e.key?(o.shouldRight=!0,o.lastArrowKey="ArrowRight"):"ArrowDown"===e.key?o.shouldDown=!0:"ArrowUp"===e.key?o.shouldRotateClockwise=!0:"z"===e.key&&(o.shouldRotateAntiClockwise=!0),o.keyPressing.add(e.key)):"pause"===o.state.gameState?o.keyPressing.has(e.key)||"Escape"===e.key&&o.resume():"gameover"===o.state.gameState&&(o.keyPressing.has(e.key)||"Enter"===e.key&&o.restart())},o.handleKeyUp=function(e){o.keyPressing.delete(e.key),["ArrowLeft","ArrowRight"].includes(e.key)&&(o.lastArrowKey=o.keyPressing.has("ArrowLeft")?"ArrowLeft":o.keyPressing.has("ArrowRight")?"ArrowRight":""),"ArrowDown"===e.key&&(o.shouldDown=!1)},o.fastForward=function(){o.debug&&console.log("fastForward");var e=o.state.board.map(function(e){return e.slice()}),t=o.tile.clone();for(t.position[1]+=1;o.checkCanPlace(e,t);)t.position[1]+=1;t.position[1]-=1,o.placeTile(e,t),o.lock()},o.down=function(){o.debug&&console.log("down");var e=o.state.board.map(function(e){return e.slice()}),t=o.tile.clone();t.position[1]+=1,o.checkCanPlace(e,t)?(clearTimeout(o.lockTimer),o.lockTimer=null,o.placeTile(e,t),e=o.state.board.map(function(e){return e.slice()}),(t=o.tile.clone()).position[1]+=1,o.checkCanPlace(e,t)||(o.lockTimer=setTimeout(o.lock,o.lockInterval))):o.lockTimer||(o.lockTimer=setTimeout(o.lock,o.lockInterval))},o.left=function(){o.debug&&console.log("left");var e=o.state.board.map(function(e){return e.slice()}),t=o.tile.clone();t.position[0]-=1,o.checkCanPlace(e,t)&&o.placeTile(e,t)},o.right=function(){o.debug&&console.log("right");var e=o.state.board.map(function(e){return e.slice()}),t=o.tile.clone();t.position[0]+=1,o.checkCanPlace(e,t)&&o.placeTile(e,t)},o.rotateClockwise=function(){o.debug&&console.log("rotateClockwise");for(var e=o.state.board.map(function(e){return e.slice()}),t=0;t<5;t++){var a=o.tile.clone();if(a.rotateClockwise(t),o.checkCanPlace(e,a)){o.placeTile(e,a);break}}},o.rotateAntiClockwise=function(){o.debug&&console.log("rotateAntiClockwise");for(var e=o.state.board.map(function(e){return e.slice()}),t=0;t<5;t++){var a=o.tile.clone();if(a.rotateAntiClockwise(t),o.checkCanPlace(e,a)){o.placeTile(e,a);break}}},o.lock=function(){o.debug&&console.log("lock"),clearTimeout(o.lockTimer);var e=o.state.board.map(function(e){return e.slice()}),t=o.tile.clone();t.position[1]+=1,o.checkCanPlace(e,t)?console.log("can place????"):(o.clearRow(),o.tile=null,o.canSpawn=!0)},o.clearRow=function(){o.debug&&console.log("clearRow");for(var e=o.tile.tile,t=o.tile.position,a=o.state.board.map(function(e){return e.slice()}),i=t[1];i<t[1]+e.length;i++)if(a[i].every(function(e){return e>-1}))for(var n=i;n>0;n--)a[n]=a[n-1];o.setState({board:a})},o.checkInBoard=function(e,t){var o=Object(f.a)(t.position,2),a=o[0],i=o[1];return a>=0&&a+t.tile[0].length<=e[0].length&&i>=0&&i+t.tile.length<=e.length},o.checkCanPlace=function(e,t,a){o.debug&&console.log("checkCanPlace");var i=o.tile;if(!o.checkInBoard(e,i))return!1;if(!o.checkInBoard(e,t))return!1;var n=i.tile,r=i.position;if(!a)for(var l=0;l<n.length;l++)for(var s=0;s<n[0].length;s++)1===n[l][s]&&(e[l+r[1]][s+r[0]]=-1);n=t.tile,r=t.position;for(var c=0;c<n.length;c++)for(var u=0;u<n[0].length;u++)if(1===n[c][u]&&e[c+r[1]][u+r[0]]>-1)return!1;return!0},o.placeShadow=function(e,t){if(o.shadow)for(var a=o.shadow.tile,i=o.shadow.position,n=0;n<a.length;n++)for(var r=0;r<a[0].length;r++)1===a[n][r]&&-2===e[n+i[1]][r+i[0]]&&(e[n+i[1]][r+i[0]]=-1);for(var l=t.clone(),s=l.tile,c=l.position,u=s.length-1+c[1];u<e.length;u++){for(var h=!0,d=s.length-1;h&&d>=0;d--)for(var f=0;h&&f<s[0].length;f++)1===s[d][f]&&e[d+c[1]][f+c[0]]>-1&&(h=!1);if(!h)break;l.position[1]+=1}l.position[1]-=1,o.shadow=l,s=o.shadow.tile,c=o.shadow.position;for(var p=0;p<s.length;p++)for(var w=0;w<s[0].length;w++)s[p][w]&&(e[p+c[1]][w+c[0]]=-2)},o.placeTile=function(e,t){o.debug&&console.log("placeTile");for(var a=o.tile.tile,i=o.tile.position,n=0;n<a.length;n++)for(var r=0;r<a[0].length;r++)1===a[n][r]&&(e[n+i[1]][r+i[0]]=-1);o.placeShadow(e,t),o.tile=t,a=o.tile.tile,i=o.tile.position;for(var l=0;l<a.length;l++)for(var s=0;s<a[0].length;s++)1===a[l][s]&&(e[l+i[1]][s+i[0]]=o.tile.type);o.setState({board:e})},o.getNextTileType=function(){var e=o.state.next[0],t=Math.floor(7*Math.random());return o.setState(function(e){return e.next.shift(),e.next.push(t),{next:e.next}}),e},o.createBoard=function(){for(var e=o.state.board,t=o.props,a=t.height,n=t.width,r=[],l=function(t){for(var a=[],l=function(r){a.push(i.a.createElement("td",{key:t*n+r,className:-2===e[t][r]?o.colors[7]:o.colors[e[t][r]]}))},s=0;s<n;s++)l(s);r.push(i.a.createElement("tr",{key:t},a))},s=1;s<a+1;s++)l(s);return i.a.createElement("tbody",null,r)},o.createNext=function(e){for(var t=o.state.next[e],a=[],n=0;n<4;n++){for(var r=[],l=0;l<4;l++)r.push(i.a.createElement("td",{key:3*n+l,className:o.colors[t]}));a.push(i.a.createElement("tr",{key:n},r))}return i.a.createElement("tbody",null,a)},o.displayText=function(){switch(o.state.gameState){case"start":return"START";case"pause":return"PAUSE";case"gameover":return"GAME OVER";default:return""}},o.onDisplayClick=function(){"start"===o.state.gameState?o.initializeGame():"pause"===o.state.gameState?o.resume():"gameover"===o.state.gameState&&o.restart()},o.arrayClone=function(e){for(var t=new Array(e.length),o=0;o<t.length;o++)t[o]=Array.from(e[o]);return t};for(var a=o.props,n=a.map,r=a.height,s=a.width,h=new Array(r+1),d=0;d<h.length;d++)h[d]=new Array(s).fill(-1);for(var p=[],k=0;k<5;k++)p.push(Math.floor(7*Math.random()));return o.state={gameState:"start",board:n||h,next:p},o.tiles=w.tiles,o.colors=w.colors,o.updateInterval=100,o.autoDownInterval=1e3/o.updateInterval,o.lockInterval=1e3,o.debug=!1,o}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){this.table.focus()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("table",{border:1},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,i.a.createElement("div",{className:this.state.gameState,onClick:this.onDisplayClick},this.displayText()),i.a.createElement("table",{id:"board",onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,tabIndex:"0",ref:function(t){return e.table=t}},this.createBoard())),i.a.createElement("td",{id:"tetris-next"},this.createNext(0),this.createNext(1),this.createNext(2),this.createNext(3),this.createNext(4))))))}}]),t}(i.a.Component),g=(o(20),function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{id:"Tetris"},i.a.createElement(k,{height:d.height,width:d.width}))}}]),t}(i.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},7:function(e,t){t.height=20,t.width=10}},[[11,2,1]]]);
//# sourceMappingURL=main.73362cbc.chunk.js.map