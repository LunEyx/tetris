(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,o){e.exports=o(22)},16:function(e,t,o){},18:function(e,t,o){},20:function(e,t,o){},22:function(e,t,o){"use strict";o.r(t);var a=o(0),n=o.n(a),i=o(9),l=o.n(i),r=(o(16),o(1)),s=o(2),c=o(4),u=o(3),h=o(5),d=o(7),f=o(10),p=(o(18),function(){function e(t,o){Object(r.a)(this,e),this.type=t,this.tile=e.tiles[t],this.color=e.colors[t],this.position=o||this.getInitialPosition(),this.rotation=0}return Object(s.a)(e,[{key:"clone",value:function(){var t=new e(this.type,this.position);return t.tile=this.tile,t.position=this.position.slice(),t.rotation=this.rotation,t}},{key:"getInitialPosition",value:function(){return[Math.floor((10-this.tile[0].length)/2),5===this.type?1:0]}},{key:"rotateClockwise",value:function(t){var o=this;this.rotation=(this.rotation+1)%4;var a,n=e.rotationClockwisePosition[this.type][this.rotation];return a=5===this.type?e.clockwiseWallKickI[this.rotation][t]:e.clockwiseWallKick[this.rotation][t],this.position[0]+=n[0]+a[0],this.position[1]+=n[1]+a[1],this.tile=this.tile[0].map(function(e,t){return o.tile.slice().reverse().map(function(e){return e[t]})}),this}},{key:"rotateAntiClockwise",value:function(t){var o=this;this.rotation=(this.rotation+3)%4;var a,n=e.rotationClockwisePosition[this.type][(this.rotation+1)%4];return a=5===this.type?e.antiClockwiseWallKickI[this.rotation][t]:e.antiClockwiseWallKick[this.rotation][t],this.position[0]-=n[0]-a[0],this.position[1]-=n[1]-a[1],this.tile=this.tile[0].map(function(e,t){return o.tile.map(function(e){return e[e.length-t-1]})}),this}}]),e}());p.tiles=[[[1,1,0],[0,1,1]],[[0,0,1],[1,1,1]],[[1,1],[1,1]],[[0,1,1],[1,1,0]],[[1,0,0],[1,1,1]],[[1,1,1,1]],[[0,1,0],[1,1,1]]],p.colors=["red","orange","yellow","green","blue","cyan","purple","grey"],p.rotationClockwisePosition=[[[0,0],[1,0],[-1,1],[0,-1]],[[0,0],[1,0],[-1,1],[0,-1]],[[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[-1,1],[0,-1]],[[0,0],[1,0],[-1,1],[0,-1]],[[-1,1],[2,-1],[-2,2],[1,-2]],[[0,0],[1,0],[-1,1],[0,-1]]],p.clockwiseWallKick=[[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]]],p.antiClockwiseWallKick=[[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]]],p.clockwiseWallKickI=[[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]]],p.antiClockwiseWallKickI=[[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]]];var w=p,k=function(e){function t(e){var o;Object(r.a)(this,t),(o=Object(c.a)(this,Object(u.a)(t).call(this,e))).initializeGame=function(){o.tile=null,o.shadow=null,o.keyPressing=o.keyPressing||new Set,o.canSpawn=!0,o.iteration=0,o.shouldFastForward=!1,o.shouldDown=!1,o.shouldLeft=!1,o.shouldRight=!1,o.shouldRotateClockwise=!1,o.shouldRotateAntiClockwise=!1,o.lastArrowKey="",o.resume()},o.pause=function(){o.shouldFastForward=!1,o.shouldDown=!1,o.shouldLeft=!1,o.shouldRight=!1,o.shouldRotateClockwise=!1,o.shouldRotateAntiClockwise=!1,o.setState({gameState:"pause"}),clearTimeout(o.updateTimer)},o.resume=function(){o.setState({gameState:"play"}),o.updateTimer=setTimeout(o.loop,o.updateInterval)},o.restart=function(){for(var e=o.props,t=e.map,a=e.height,n=e.width,i=new Array(a+1),l=0;l<i.length;l++)i[l]=new Array(n).fill(-1);for(var r=[],s=0;s<5;s++)r.push(Math.floor(7*Math.random()));o.setState({board:t||i,next:r}),o.initializeGame()},o.loop=function(){o.canSpawn?o.spawn():o.tile&&(o.shouldFastForward?(o.debug&&console.log("shouldFastForward"),o.fastForward()):(o.iteration===o.autoDownInterval&&(o.debug&&console.log("autoDown"),o.down(),o.iteration=0),o.shouldDown&&o.down(),o.shouldLeft||"ArrowLeft"===o.lastArrowKey?(o.left(),o.shouldLeft=!1):(o.shouldRight||"ArrowRight"===o.lastArrowKey)&&(o.right(),o.shouldRight=!1),o.shouldRotateClockwise&&(o.rotateClockwise(),o.shouldRotateClockwise=!1),o.shouldRotateAntiClockwise&&(o.rotateAntiClockwise(),o.shouldRotateAntiClockwise=!1),o.iteration+=1),o.shouldFastForward=!1),"play"===o.state.gameState&&(o.updateTimer=setTimeout(o.loop,o.updateInterval))},o.spawn=function(){o.debug&&console.log("spawn"),o.canSpawn=!1,o.lockTimer=null,o.tile=new w(o.getNextTileType());var e=o.state.board.map(function(e){return e.slice()});o.checkCanPlace(e,o.tile,!0)?o.placeTile(e,o.tile):o.setState({gameState:"gameover"})},o.handleKeyDown=function(e){"start"===o.state.gameState?o.initializeGame():"play"===o.state.gameState?o.keyPressing.has(e.key)||("Escape"===e.key?o.pause():" "===e.key?o.shouldFastForward=!0:"ArrowLeft"===e.key?(o.shouldLeft=!0,o.lastArrowKey="ArrowLeft"):"ArrowRight"===e.key?(o.shouldRight=!0,o.lastArrowKey="ArrowRight"):"ArrowDown"===e.key?o.shouldDown=!0:"ArrowUp"===e.key?o.shouldRotateClockwise=!0:"z"===e.key&&(o.shouldRotateAntiClockwise=!0),o.keyPressing.add(e.key)):"pause"===o.state.gameState?o.keyPressing.has(e.key)||"Escape"===e.key&&o.resume():"gameover"===o.state.gameState&&(o.keyPressing.has(e.key)||"Enter"===e.key&&o.restart())},o.handleKeyUp=function(e){o.keyPressing.delete(e.key),["ArrowLeft","ArrowRight"].includes(e.key)&&(o.lastArrowKey=o.keyPressing.has("ArrowLeft")?"ArrowLeft":o.keyPressing.has("ArrowRight")?"ArrowRight":""),"ArrowDown"===e.key&&(o.shouldDown=!1)},o.fastForward=function(){o.debug&&console.log("fastForward");var e=o.state.board.map(function(e){return e.slice()}),t=o.tile.clone();for(t.position[1]+=1;o.checkCanPlace(e,t);)t.position[1]+=1;t.position[1]-=1,o.placeTile(e,t),o.lock()},o.down=function(){o.debug&&console.log("down");var e=o.state.board.map(function(e){return e.slice()}),t=o.tile.clone();t.position[1]+=1,o.checkCanPlace(e,t)?(clearTimeout(o.lockTimer),o.lockTimer=null,o.placeTile(e,t),e=o.state.board.map(function(e){return e.slice()}),(t=o.tile.clone()).position[1]+=1,o.checkCanPlace(e,t)||(o.lockTimer=setTimeout(o.lock,o.lockInterval))):o.lockTimer||(o.lockTimer=setTimeout(o.lock,o.lockInterval))},o.left=function(){o.debug&&console.log("left");var e=o.state.board.map(function(e){return e.slice()}),t=o.tile.clone();t.position[0]-=1,o.checkCanPlace(e,t)&&o.placeTile(e,t)},o.right=function(){o.debug&&console.log("right");var e=o.state.board.map(function(e){return e.slice()}),t=o.tile.clone();t.position[0]+=1,o.checkCanPlace(e,t)&&o.placeTile(e,t)},o.rotateClockwise=function(){o.debug&&console.log("rotateClockwise");for(var e=o.state.board.map(function(e){return e.slice()}),t=0;t<5;t++){var a=o.tile.clone();if(a.rotateClockwise(t),o.checkCanPlace(e,a)){o.placeTile(e,a);break}}},o.rotateAntiClockwise=function(){o.debug&&console.log("rotateAntiClockwise");for(var e=o.state.board.map(function(e){return e.slice()}),t=0;t<5;t++){var a=o.tile.clone();if(a.rotateAntiClockwise(t),o.checkCanPlace(e,a)){o.placeTile(e,a);break}}},o.lock=function(){o.debug&&console.log("lock"),clearTimeout(o.lockTimer);var e=o.state.board.map(function(e){return e.slice()}),t=o.tile.clone();t.position[1]+=1,o.checkCanPlace(e,t)?console.log("can place????"):(o.clearRow(),o.tile=null,o.canSpawn=!0)},o.clearRow=function(){o.debug&&console.log("clearRow");for(var e=o.tile.tile,t=o.tile.position,a=o.state.board.map(function(e){return e.slice()}),n=t[1];n<t[1]+e.length;n++)if(a[n].every(function(e){return e>-1}))for(var i=n;i>0;i--)a[i]=a[i-1];o.setState({board:a})},o.checkInBoard=function(e,t){var o=Object(f.a)(t.position,2),a=o[0],n=o[1];return a>=0&&a+t.tile[0].length<=e[0].length&&n>=0&&n+t.tile.length<=e.length},o.checkCanPlace=function(e,t,a){o.debug&&console.log("checkCanPlace");var n=o.tile;if(!o.checkInBoard(e,n))return!1;if(!o.checkInBoard(e,t))return!1;var i=n.tile,l=n.position;if(!a)for(var r=0;r<i.length;r++)for(var s=0;s<i[0].length;s++)1===i[r][s]&&(e[r+l[1]][s+l[0]]=-1);i=t.tile,l=t.position;for(var c=0;c<i.length;c++)for(var u=0;u<i[0].length;u++)if(1===i[c][u]&&e[c+l[1]][u+l[0]]>-1)return!1;return!0},o.placeShadow=function(e,t){if(o.shadow)for(var a=o.shadow.tile,n=o.shadow.position,i=0;i<a.length;i++)for(var l=0;l<a[0].length;l++)1===a[i][l]&&-2===e[i+n[1]][l+n[0]]&&(e[i+n[1]][l+n[0]]=-1);for(var r=t.clone(),s=r.tile,c=r.position,u=s.length-1+c[1];u<e.length;u++){for(var h=!0,d=s.length-1;h&&d>=0;d--)for(var f=0;h&&f<s[0].length;f++)1===s[d][f]&&e[d+c[1]][f+c[0]]>-1&&(h=!1);if(!h)break;r.position[1]+=1}r.position[1]-=1,o.shadow=r,s=o.shadow.tile,c=o.shadow.position;for(var p=0;p<s.length;p++)for(var w=0;w<s[0].length;w++)s[p][w]&&(e[p+c[1]][w+c[0]]=-2)},o.placeTile=function(e,t){o.debug&&console.log("placeTile");for(var a=o.tile.tile,n=o.tile.position,i=0;i<a.length;i++)for(var l=0;l<a[0].length;l++)1===a[i][l]&&(e[i+n[1]][l+n[0]]=-1);o.placeShadow(e,t),o.tile=t,a=o.tile.tile,n=o.tile.position;for(var r=0;r<a.length;r++)for(var s=0;s<a[0].length;s++)1===a[r][s]&&(e[r+n[1]][s+n[0]]=o.tile.type);o.setState({board:e})},o.getNextTileType=function(){var e=o.state.next[0],t=Math.floor(7*Math.random());return o.setState(function(e){return e.next.shift(),e.next.push(t),{next:e.next}}),e},o.createBoard=function(){for(var e=o.state.board,t=o.props,a=t.height,i=t.width,l=[],r=function(t){for(var a=[],r=function(l){a.push(n.a.createElement("td",{key:t*i+l,className:-2===e[t][l]?o.colors[7]:o.colors[e[t][l]]}))},s=0;s<i;s++)r(s);l.push(n.a.createElement("tr",{key:t},a))},s=1;s<a+1;s++)r(s);return n.a.createElement("tbody",null,l)},o.createNext=function(e){for(var t=o.state.next[e],a=[],i=0;i<3;i++){for(var l=[],r=0;r<4;r++){var s="";o.tiles[t][i]&&1===o.tiles[t][i][r]&&(s="colored"),l.push(n.a.createElement("td",{key:3*i+r,className:s?o.colors[t]:""}))}a.push(n.a.createElement("tr",{key:i},l))}return n.a.createElement("table",null,n.a.createElement("tbody",null,a))},o.displayText=function(){switch(o.state.gameState){case"start":return"START";case"pause":return"PAUSE";case"gameover":return"GAME OVER";default:return""}},o.onDisplayClick=function(){"start"===o.state.gameState?o.initializeGame():"pause"===o.state.gameState?o.resume():"gameover"===o.state.gameState&&o.restart()},o.arrayClone=function(e){for(var t=new Array(e.length),o=0;o<t.length;o++)t[o]=Array.from(e[o]);return t};for(var a=o.props,i=a.map,l=a.height,s=a.width,h=new Array(l+1),d=0;d<h.length;d++)h[d]=new Array(s).fill(-1);for(var p=[],k=0;k<5;k++)p.push(Math.floor(7*Math.random()));return o.state={gameState:"start",board:i||h,next:p},o.tiles=w.tiles,o.colors=w.colors,o.updateInterval=100,o.autoDownInterval=1e3/o.updateInterval,o.lockInterval=1e3,o.debug=!1,o}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){this.table.focus()}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("table",null,n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("div",{className:this.state.gameState,onClick:this.onDisplayClick},this.displayText()),n.a.createElement("table",{id:"board",onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,tabIndex:"0",ref:function(t){return e.table=t}},this.createBoard())),n.a.createElement("td",{id:"tetris-next"},this.createNext(0),this.createNext(1),this.createNext(2),this.createNext(3),this.createNext(4))))),n.a.createElement("div",{id:"help"},"How to play ",n.a.createElement("br",null),"Click on START to start",n.a.createElement("table",null,n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,"\u2190\u2192"),n.a.createElement("td",null,"move left/right")),n.a.createElement("tr",null,n.a.createElement("td",null,"\u2193"),n.a.createElement("td",null,"move down faster")),n.a.createElement("tr",null,n.a.createElement("td",null,"SPACE"),n.a.createElement("td",null,"move down to bottom instantly")),n.a.createElement("tr",null,n.a.createElement("td",null,"\u2191"),n.a.createElement("td",null,"rotate clockwise")),n.a.createElement("tr",null,n.a.createElement("td",null,"z"),n.a.createElement("td",null,"rotate anti-clockwise"))))))}}]),t}(n.a.Component),m=(o(20),function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{id:"Tetris"},n.a.createElement(k,{height:d.height,width:d.width}))}}]),t}(n.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(m,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},7:function(e,t){t.height=20,t.width=10}},[[11,2,1]]]);
//# sourceMappingURL=main.6d591d2d.chunk.js.map